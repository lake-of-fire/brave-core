--- a/Sources/BraveAdblockRust/src/engine.rs
+++ b/Sources/BraveAdblockRust/src/engine.rs
@@ -13,9 +13,10 @@
 use cxx::{let_cxx_string, CxxString, CxxVector};
 
 use crate::ffi::{
-    resolve_domain_position, BlockerResult, BoxEngineResult, ContentBlockingRulesResult, DebugInfo,
-    FilterListMetadata, RegexManagerDiscardPolicy, VecStringResult,
+    BlockerResult, BoxEngineResult, ContentBlockingRulesResult, DebugInfo, FilterListMetadata,
+    RegexManagerDiscardPolicy, VecStringResult,
 };
+use psl::domain;
 use crate::filter_set::FilterSet;
 use crate::result::InternalError;
 
@@ -59,9 +60,18 @@
 
 impl ResolvesDomain for DomainResolver {
     fn get_host_domain(&self, host: &str) -> (usize, usize) {
-        let_cxx_string!(host_cxx_string = host);
-        let position = resolve_domain_position(&host_cxx_string);
-        (position.start as usize, position.end as usize)
+        let trimmed = host.trim_end_matches('.');
+        if trimmed.is_empty() {
+            return (0, 0);
+        }
+        if let Some(domain) = domain(trimmed.as_bytes()) {
+            if let Ok(domain_str) = std::str::from_utf8(domain.as_bytes()) {
+                if let Some(start) = trimmed.rfind(domain_str) {
+                    return (start, start + domain_str.len());
+                }
+            }
+        }
+        (0, trimmed.len())
     }
 }
 
